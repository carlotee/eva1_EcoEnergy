{% extends "dispositivos/base.html" %}

{% block content %}
<h2>Lista de Dispositivos</h2>

<form method="GET" action="{% url 'listar_dispositivos' %}" class="mb-4">
    <div class="row">
        <div class="col-md-4">
            <label for="categoria-filtro" class="form-label">Filtrar por Categoría:</label>
            <select name="categoria" id="categoria-filtro" class="form-select">
                <option value="">Todas las categorías</option>
                {% for categoria in categorias %}
                    <option value="{{ categoria.id }}" {% if categoria.id == categoria_seleccionada %}selected{% endif %}>
                        {{ categoria.nombre }}
                    </option>
                {% endfor %}
            </select>
        </div>
        <div class="col-md-2 d-flex align-items-end">
            <button type="submit" class="btn btn-primary">Aplicar Filtro</button>
        </div>
    </div>
</form>

<table class="table table-striped table-hover">
    <thead>
        <tr>
            <th>Nombre</th>
            <th>Categoría</th>
            <th>Zona</th>
            <th>Consumo Máximo</th>
            <th>Estado</th>
            <th>Acciones</th>
        </tr>
    </thead>
    <tbody>
        {% for dispositivo in dispositivos %}
            <tr>
                <td>{{ dispositivo.nombre }}</td>
                <td>{{ dispositivo.categoria }}</td>
                <td>{{ dispositivo.zona }}</td>
                <td>{{ dispositivo.consumo_maximo }}</td>
                <td>{{ dispositivo.estado }}</td>
                <td>
                    <a href="{% url 'editar_dispositivo' dispositivo.id %}" class="btn btn-warning btn-sm">Editar</a>
                    <a href="{% url 'eliminar_dispositivo' dispositivo.id %}" class="btn btn-danger btn-sm">Eliminar</a>
                </td>
            </tr>
        {% empty %}
            <tr>
                <td colspan="6" class="text-center">No hay dispositivos registrados.</td>
            </tr>
        {% endfor %}
    </tbody>
</table>

<a href="{% url 'crear_dispositivos' %}" class="btn btn-success mt-3">Agregar nuevo dispositivo</a>
{% endblock %}
